# 编程概念和基本语法

这一节开始就要正式进入编程的世界了！

在本节，你将完成一个最基本的rust程序

> 本文中提到的所有有快捷键都是vsc的快捷键

# 项目

什么是项目？

我的理解是，一系列组成这个程序的东西构成的一个整体。操作，配置和使用一整个项目相比于使用一大堆文件来说，是极其简单的

rust程序员很有使用项目的习惯。其他语言的初学者都是从单文件再到项目，但是rust程序员对项目的使用是“从小培养的”

> 在rust，项目被称为`crate`

## 创建项目

创建项目有两种方案，建议windows使用cargo init，因为windwos使用终端不是很方便

> 只有在编辑器打开项目文件夹，才可以享受来自`rust-analyzer`的强大支持

> `rust-analyzer`：rust的lsp(语言服务器协议)实现，作用是让编辑器能够补全，重构rust代码，并且提供大量可以辅助编写rust代码的功能。它可以极大简便rust的开发

1. cargo init：在一个文件夹下的终端内运行`cargo init`，这个文件夹就是项目文件夹

2. cargo new: 在一个文件夹下的终端内运行`cargo new <项目的名字>`，将会创建一个和项目同名的文件夹，那个文件夹才是真正的项目文件夹

你可以这样做：

1. 在一个你喜欢的位置创建一个空文件夹

2. 使用编辑器打开这个空文件夹

3. 打开编辑器的终端，输入`cargo init`，然后回车运行

你可以按下以下快捷键来进行操作：

* `ctrl + k` 然后 `ctrl + o` 打开文件夹

* ctrl + shfit + \`打开终端

然后点击界面左上角的文件图标，或者`ctrl + shift + e`打开`文件资源管理器`
## 项目结构

你可以看到有一个叫`src`文件夹，和一个叫`Cargo.toml`的文件 

* `src`文件夹是存放源代码的文件夹

* `Cargo.toml`文件是负责描述项目的文件，其具体作用后面才会介绍

打开`src`文件夹，你可以看到一个叫`main.rs`的文件，单击以打开它

> `rs`是rust源代码文件的后缀名

此时你的界面大概是这样的![](./basic_programming/editor.png)

*第一次加载可能会略微有些慢，请耐心等待，基本不会出问题。*

*但是如果你是Windwos并且加载极其缓慢，你可能可以查阅[这里](./install.md#windows下的奇怪问题)来解决问题 ~~血的教训~~* 

如果你的编辑器正常运作，你会看到

* 左边多出了`Cargo.lock`文件和`target`文件夹

* `fn main`上面会有`Run | Debug`的字样

`main.rs`如同它的名字，这是这个项目的"主要文件"，看看它的内容:

```rust
fn main() {
    println!("Hello World")
}
```
> 你可以点击本网页上代码框右上角的一个按钮来一键复制代码。或者按另一个箭头标志的按钮来运行代码，直接在网页看到代码的运行效果。但是可能会显示`Playground Communication: timeout`之类的，这是网络问题

> 你可以点击你的编辑器中`fn main`上的`Run`来一键运行代码，这是`rust-analyzer`插件提供的便利功能

# 函数

对于数学中的一个函数$f(x) = x^2$，如果要用rust写一个同样功能的函数，会是这样的
```rust 
fn f(x: f64) -> f64 {
    x * x
}
```

> 如果复制这段代码进编辑器，你可能会受到一个叫`unused`的`警告`，黄色的是警告不会破坏代码运行，但是可能会带来一些问题<br>
> 而红色的是`错误`，有错误的代码无法编译成功，更无法运行

那么，这段代码是什么意思呢

`fn`的意思是`function`(函数) 它是一个`关键字`，在这里的作用是声明一个函数

而`fn`后面紧接着的，就是函数的名字，这里是`f`。函数名后面，就是参数表

`(x: f64)`的意思是：接受一个f64类型的参数，在函数里通过x使用它

> f64: 64位浮点数类型

那么`-> f64` 呢？它的意思是：这个函数返回一个f64类型的值。如果这一部分省略，就说明函数没有返回值

之后的被`{ }`包裹的就是`函数体`了，也就是这个函数被调用时实际上会执行的代码

> 使用一个函数被称为调用

然后

看看另一个例子：

$add(x,y) =x+y$

```rust
fn add(x: f64, y: f64) -> f64 {
    x + y
}
```

## 使用函数

函数可以这样使用：
```rust
# fn f(x: f64) -> f64 {
#     x * x
# }
# 
# fn add(x: f64, y: f64) -> f64 {
#     x + y
# }
# fn main (){
add(1,2);
# }
```

rust的语句以`;`结尾

> 注意切换为英文输入法，全部符号都是英文符号(半角符号)

而`f`和`add`内部没有`;`是因为那不是一个语句，而是一个值。如果`f`和`add`里也加上`;` 那么实际上返回的是`()`（单元类型，你可以理解为什么都不是，就是一种意义上的空），和标注的`f64`不符合

> 为什么要标注类型？难道没办法自己推断出来嘛？ <br>
> *这是一个比较高级的话题，有的情况真就没法推断出来*


add函数会返回一个f64类型的数据，那么，函数就可以这样嵌套使用
```rust
# fn f(x: f64) -> f64 {
#     x * x
# }
# 
# fn add(x: f64, y: f64) -> f64 {
#     x + y
# }
# fn main (){
f(add(1,2)) + f(add(3,4));
# }
```
等同于
```rust
# fn f(x: f64) -> f64 {
#     x * x
# }
# 
# fn add(x: f64, y: f64) -> f64 {
#     x + y
# }
# fn main (){
f(1 + 2) + f(3 + 4);
# }
```

> 你可以点击代码框里的小眼睛，来查看被我隐藏的代码(只是排版上的隐藏，让你聚集到重点)

如果你显示被隐藏的代码，你可以看见`f(add(1,2)) + f(add(3,4));`这行代码实际上是放在`main`函数的声明里

这样做的原因是，除了声明，别的语句都得在函数里才可以被执行

而main函数就是嵌套的终止，程序从main函数开始运行，放进main里的代码在程序运行时会被执行

> main又是怎么被调用的呢？这也是一个比较高级的话题，你可以理解为：你下达的指令让操作系统执行了main函数